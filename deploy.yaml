apps:
  - name: nes_fe
    script: .output/server/index.mjs
    instances: max
    exec_mode: cluster
    env_file: '.env'
    env:
      PORT: 3001
      NODE_ENV: production
      NES_API_BASE: 'http://localhost:8081'

deploy:
  production:
    user: 'root'
    host: '69.62.86.33'
    ref: 'origin/main'
    repo: 'https://github.com/swiftzL/nes_fe'
    path: '/var/www/nes_fe'
    pre-deploy: 'source ~/.bashrc && git fetch --all'
    post-deploy: 'export PATH=$HOME/n/bin:$PATH && npm install && npm run build && pm2 reload deploy.yaml'
    env:
      NES_API_BASE: 'http://127.0.0.1:8081'
      NES_IMAGE_BASE: 'https://bin9.vae88.com/files/img/'
      CLERK_PUBLISHABLE_KEY: 'pk_test_d2lzZS1jcmlja2V0LTc2LmNsZXJrLmFjY291bnRzLmRldiQ'
      NUXT_PUBLIC_CLERK_PUBLISHABLE_KEY: 'pk_test_d2lzZS1jcmlja2V0LTc2LmNsZXJrLmFjY291bnRzLmRldiQ'
      NUXT_CLERK_SECRET_KEY: 'sk_test_qMg4tGrTMT9zu29fY1GrGKcsaWEFR9Z3w585IIB11c'
      MICROSOFT_CLARITY_ID: 'ud1nvqod6x'
